{"version":3,"file":"commit-message.js","sourceRoot":"","sources":["../../../../../lib/workers/repository/config-migration/branch/commit-message.ts"],"names":[],"mappings":";;;;AACA,4EAAsD;AAEtD,+EAA0E;AAE1E,MAAa,mCAAmC;IAK9C,YAAY,MAAsB,EAAE,UAAkB;QACpD,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;IAC/B,CAAC;IAED,MAAM;QACJ,MAAM,EAAE,aAAa,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC;QAEtC,IAAI,CAAC,MAAM,CAAC,mBAAmB;YAC7B,IAAI,CAAC,MAAM,CAAC,mBAAmB,KAAK,QAAQ;gBAC1C,CAAC,CAAC,EAAE;gBACJ,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,mBAAmB,CAAC;QAEtC,IAAI,CAAC,MAAM,CAAC,kBAAkB;YAC5B,IAAI,CAAC,MAAM,CAAC,kBAAkB,KAAK,wBAAwB;gBACzD,CAAC,CAAC,kBAAkB,IAAI,CAAC,UAAU,EAAE;gBACrC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,kBAAkB,CAAC;QAErC,IAAI,CAAC,MAAM,CAAC,kBAAkB,GAAG,EAAE,CAAC;QACpC,IAAI,CAAC,MAAM,CAAC,mBAAmB,GAAG,QAAQ,CAAC;QAE3C,MAAM,oBAAoB,GAAG,IAAI,6CAAoB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QACnE,MAAM,MAAM,GAAG,oBAAoB,CAAC,MAAM,EAAE,CAAC;QAE7C,IAAI,aAAa,EAAE;YACjB,MAAM,CAAC,OAAO,GAAG,QAAQ,CAAC,OAAO,CAAC,aAAa,EAAE;gBAC/C,GAAG,IAAI,CAAC,MAAM;gBACd,mBAAmB,EAAE,EAAE;aACxB,CAAC,CAAC;SACJ;aAAM;YACL,MAAM,CAAC,OAAO,GAAG,kBAAkB,IAAI,CAAC,UAAU,EAAE,CAAC;SACtD;QAED,OAAO,MAAM,CAAC;IAChB,CAAC;CACF;AAxCD,kFAwCC","sourcesContent":["import type { RenovateConfig } from '../../../../config/types';\nimport * as template from '../../../../util/template';\nimport type { CommitMessage } from '../../model/commit-message';\nimport { CommitMessageFactory } from '../../model/commit-message-factory';\n\nexport class ConfigMigrationCommitMessageFactory {\n  private readonly config: RenovateConfig;\n\n  private readonly configFile: string;\n\n  constructor(config: RenovateConfig, configFile: string) {\n    this.config = config;\n    this.configFile = configFile;\n  }\n\n  create(): CommitMessage {\n    const { commitMessage } = this.config;\n\n    this.config.commitMessageAction =\n      this.config.commitMessageAction === 'Update'\n        ? ''\n        : this.config.commitMessageAction;\n\n    this.config.commitMessageTopic =\n      this.config.commitMessageTopic === 'dependency {{depName}}'\n        ? `Migrate config ${this.configFile}`\n        : this.config.commitMessageTopic;\n\n    this.config.commitMessageExtra = '';\n    this.config.semanticCommitScope = 'config';\n\n    const commitMessageFactory = new CommitMessageFactory(this.config);\n    const commit = commitMessageFactory.create();\n\n    if (commitMessage) {\n      commit.subject = template.compile(commitMessage, {\n        ...this.config,\n        commitMessagePrefix: '',\n      });\n    } else {\n      commit.subject = `Migrate config ${this.configFile}`;\n    }\n\n    return commit;\n  }\n}\n"]}